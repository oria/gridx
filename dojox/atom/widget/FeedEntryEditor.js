//>>built
require({cache:{"url:dojox/atom/widget/templates/FeedEntryEditor.html":'<div class="feedEntryViewer">\r\n    <table border="0" width="100%" class="feedEntryViewerMenuTable" dojoAttachPoint="feedEntryViewerMenu" style="display: none;">\r\n        <tr width="100%"  dojoAttachPoint="entryCheckBoxDisplayOptions">\r\n        \t<td align="left" dojoAttachPoint="entryNewButton">\r\n                <span class="feedEntryViewerMenu" dojoAttachPoint="doNew" dojoAttachEvent="onclick:_toggleNew"></span>\r\n        \t</td>\r\n            <td align="left" dojoAttachPoint="entryEditButton" style="display: none;">\r\n                <span class="feedEntryViewerMenu" dojoAttachPoint="edit" dojoAttachEvent="onclick:_toggleEdit"></span>\r\n            </td>\r\n            <td align="left" dojoAttachPoint="entrySaveCancelButtons" style="display: none;">\r\n                <span class="feedEntryViewerMenu" dojoAttachPoint="save" dojoAttachEvent="onclick:saveEdits"></span>\r\n                <span class="feedEntryViewerMenu" dojoAttachPoint="cancel" dojoAttachEvent="onclick:cancelEdits"></span>\r\n            </td>\r\n            <td align="right">\r\n                <span class="feedEntryViewerMenu" dojoAttachPoint="displayOptions" dojoAttachEvent="onclick:_toggleOptions"></span>\r\n            </td>\r\n        </tr>\r\n        <tr class="feedEntryViewerDisplayCheckbox" dojoAttachPoint="entryCheckBoxRow" width="100%" style="display: none;">\r\n            <td dojoAttachPoint="feedEntryCelltitle">\r\n                <input type="checkbox" name="title" value="Title" dojoAttachPoint="feedEntryCheckBoxTitle" dojoAttachEvent="onclick:_toggleCheckbox"/>\r\n\t\t\t\t<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelTitle"></label>\r\n            </td>\r\n            <td dojoAttachPoint="feedEntryCellauthors">\r\n                <input type="checkbox" name="authors" value="Authors" dojoAttachPoint="feedEntryCheckBoxAuthors" dojoAttachEvent="onclick:_toggleCheckbox"/>\r\n\t\t\t\t<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelAuthors"></label>\r\n            </td>\r\n            <td dojoAttachPoint="feedEntryCellcontributors">\r\n                <input type="checkbox" name="contributors" value="Contributors" dojoAttachPoint="feedEntryCheckBoxContributors" dojoAttachEvent="onclick:_toggleCheckbox"/>\r\n\t\t\t\t<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelContributors"></label>\r\n            </td>\r\n            <td dojoAttachPoint="feedEntryCellid">\r\n                <input type="checkbox" name="id" value="Id" dojoAttachPoint="feedEntryCheckBoxId" dojoAttachEvent="onclick:_toggleCheckbox"/>\r\n\t\t\t\t<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelId"></label>\r\n            </td>\r\n            <td rowspan="2" align="right">\r\n                <span class="feedEntryViewerMenu" dojoAttachPoint="close" dojoAttachEvent="onclick:_toggleOptions"></span>\r\n            </td>\r\n\t\t</tr>\r\n\t\t<tr class="feedEntryViewerDisplayCheckbox" dojoAttachPoint="entryCheckBoxRow2" width="100%" style="display: none;">\r\n            <td dojoAttachPoint="feedEntryCellupdated">\r\n                <input type="checkbox" name="updated" value="Updated" dojoAttachPoint="feedEntryCheckBoxUpdated" dojoAttachEvent="onclick:_toggleCheckbox"/>\r\n\t\t\t\t<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelUpdated"></label>\r\n            </td>\r\n            <td dojoAttachPoint="feedEntryCellsummary">\r\n                <input type="checkbox" name="summary" value="Summary" dojoAttachPoint="feedEntryCheckBoxSummary" dojoAttachEvent="onclick:_toggleCheckbox"/>\r\n\t\t\t\t<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelSummary"></label>\r\n            </td>\r\n            <td dojoAttachPoint="feedEntryCellcontent">\r\n                <input type="checkbox" name="content" value="Content" dojoAttachPoint="feedEntryCheckBoxContent" dojoAttachEvent="onclick:_toggleCheckbox"/>\r\n\t\t\t\t<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelContent"></label>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    \r\n    <table class="feedEntryViewerContainer" border="0" width="100%">\r\n        <tr class="feedEntryViewerTitle" dojoAttachPoint="entryTitleRow" style="display: none;">\r\n            <td>\r\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\r\n                    <tr class="graphic-tab-lgray">\r\n\t\t\t\t\t\t<td class="lp2">\r\n\t\t\t\t\t\t\t<span class="lp" dojoAttachPoint="entryTitleHeader"></span>\r\n\t\t\t\t\t\t</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>\r\n                        \t<select dojoAttachPoint="entryTitleSelect" dojoAttachEvent="onchange:_switchEditor" style="display: none">\r\n                        \t\t<option value="text">Text</option>\r\n\t\t\t\t\t\t\t\t<option value="html">HTML</option>\r\n\t\t\t\t\t\t\t\t<option value="xhtml">XHTML</option>\r\n                        \t</select>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan="2" dojoAttachPoint="entryTitleNode">\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n            </td>\r\n        </tr>\r\n\r\n        <tr class="feedEntryViewerAuthor" dojoAttachPoint="entryAuthorRow" style="display: none;">\r\n            <td>\r\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\r\n                    <tr class="graphic-tab-lgray">\r\n\t\t\t\t\t\t<td class="lp2">\r\n\t\t\t\t\t\t\t<span class="lp" dojoAttachPoint="entryAuthorHeader"></span>\r\n\t\t\t\t\t\t</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td dojoAttachPoint="entryAuthorNode">\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n            </td>\r\n        </tr>\r\n\r\n        <tr class="feedEntryViewerContributor" dojoAttachPoint="entryContributorRow" style="display: none;">\r\n            <td>\r\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\r\n                    <tr class="graphic-tab-lgray">\r\n\t\t\t\t\t\t<td class="lp2">\r\n\t\t\t\t\t\t\t<span class="lp" dojoAttachPoint="entryContributorHeader"></span>\r\n\t\t\t\t\t\t</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td dojoAttachPoint="entryContributorNode" class="feedEntryViewerContributorNames">\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n            </td>\r\n        </tr>\r\n        \r\n        <tr class="feedEntryViewerId" dojoAttachPoint="entryIdRow" style="display: none;">\r\n            <td>\r\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\r\n                    <tr class="graphic-tab-lgray">\r\n\t\t\t\t\t\t<td class="lp2">\r\n\t\t\t\t\t\t\t<span class="lp" dojoAttachPoint="entryIdHeader"></span>\r\n\t\t\t\t\t\t</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td dojoAttachPoint="entryIdNode" class="feedEntryViewerIdText">\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n            </td>\r\n        </tr>\r\n    \r\n        <tr class="feedEntryViewerUpdated" dojoAttachPoint="entryUpdatedRow" style="display: none;">\r\n            <td>\r\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\r\n                    <tr class="graphic-tab-lgray">\r\n\t\t\t\t\t\t<td class="lp2">\r\n\t\t\t\t\t\t\t<span class="lp" dojoAttachPoint="entryUpdatedHeader"></span>\r\n\t\t\t\t\t\t</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td dojoAttachPoint="entryUpdatedNode" class="feedEntryViewerUpdatedText">\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n            </td>\r\n        </tr>\r\n    \r\n        <tr class="feedEntryViewerSummary" dojoAttachPoint="entrySummaryRow" style="display: none;">\r\n            <td>\r\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\r\n                    <tr class="graphic-tab-lgray">\r\n\t\t\t\t\t\t<td class="lp2" colspan="2">\r\n\t\t\t\t\t\t\t<span class="lp" dojoAttachPoint="entrySummaryHeader"></span>\r\n\t\t\t\t\t\t</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>\r\n                        \t<select dojoAttachPoint="entrySummarySelect" dojoAttachEvent="onchange:_switchEditor" style="display: none">\r\n                        \t\t<option value="text">Text</option>\r\n\t\t\t\t\t\t\t\t<option value="html">HTML</option>\r\n\t\t\t\t\t\t\t\t<option value="xhtml">XHTML</option>\r\n                        \t</select>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td dojoAttachPoint="entrySummaryNode">\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n            </td>\r\n        </tr>\r\n    \r\n        <tr class="feedEntryViewerContent" dojoAttachPoint="entryContentRow" style="display: none;">\r\n            <td>\r\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\r\n                    <tr class="graphic-tab-lgray">\r\n\t\t\t\t\t\t<td class="lp2">\r\n\t\t\t\t\t\t\t<span class="lp" dojoAttachPoint="entryContentHeader"></span>\r\n\t\t\t\t\t\t</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>\r\n                        \t<select dojoAttachPoint="entryContentSelect" dojoAttachEvent="onchange:_switchEditor" style="display: none">\r\n                        \t\t<option value="text">Text</option>\r\n\t\t\t\t\t\t\t\t<option value="html">HTML</option>\r\n\t\t\t\t\t\t\t\t<option value="xhtml">XHTML</option>\r\n                        \t</select>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td dojoAttachPoint="entryContentNode">\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n</div>\r\n',
"url:dojox/atom/widget/templates/PeopleEditor.html":'<div class="peopleEditor">\r\n\t<table style="width: 100%">\r\n\t\t<tbody dojoAttachPoint="peopleEditorEditors"></tbody>\r\n\t</table>\r\n\t<span class="peopleEditorButton" dojoAttachPoint="peopleEditorButton" dojoAttachEvent="onclick:_add"></span>\r\n</div>'}});
define("dojox/atom/widget/FeedEntryEditor","dojo/_base/kernel,dojo/_base/lang,dojo/_base/connect,dojo/_base/declare,dojo/_base/fx,dojo/_base/sniff,dojo/dom,dojo/dom-style,dojo/dom-construct,dijit/_Widget,dijit/_Templated,dijit/_Container,dijit/Editor,dijit/form/TextBox,dijit/form/SimpleTextarea,./FeedEntryViewer,../io/model,dojo/text!./templates/FeedEntryEditor.html,dojo/text!./templates/PeopleEditor.html,dojo/i18n!./nls/FeedEntryViewer,dojo/i18n!./nls/FeedEntryEditor,dojo/i18n!./nls/PeopleEditor".split(","),function(n,
q,w,r,x,s,t,g,u,y,z,A,m,o,v,j,l,B,C,k,D,p){n.experimental("dojox.atom.widget.FeedEntryEditor");var i=r("dojox.atom.widget.FeedEntryEditor",j,{_contentEditor:null,_oldContent:null,_setObject:null,enableEdit:!1,_contentEditorCreator:null,_editors:{},entryNewButton:null,_editable:!1,templateString:B,postCreate:function(){if(""!==this.entrySelectionTopic)this._subscriptions=[n.subscribe(this.entrySelectionTopic,this,"_handleEvent")];var a=k;this.displayOptions.innerHTML=a.displayOptions;this.feedEntryCheckBoxLabelTitle.innerHTML=
a.title;this.feedEntryCheckBoxLabelAuthors.innerHTML=a.authors;this.feedEntryCheckBoxLabelContributors.innerHTML=a.contributors;this.feedEntryCheckBoxLabelId.innerHTML=a.id;this.close.innerHTML=a.close;this.feedEntryCheckBoxLabelUpdated.innerHTML=a.updated;this.feedEntryCheckBoxLabelSummary.innerHTML=a.summary;this.feedEntryCheckBoxLabelContent.innerHTML=a.content;a=D;this.doNew.innerHTML=a.doNew;this.edit.innerHTML=a.edit;this.save.innerHTML=a.save;this.cancel.innerHTML=a.cancel},setEntry:function(a,
b,c){c=this._entry!==a?this._editMode=!1:!0;i.superclass.setEntry.call(this,a,b);this._editable=this._isEditable(a);!c&&!this._editable&&(g.set(this.entryEditButton,"display","none"),g.set(this.entrySaveCancelButtons,"display","none"));this._editable&&this.enableEdit&&!c&&(g.set(this.entryEditButton,"display",""),this.enableMenuFade&&this.entrySaveCancelButton&&x.fadeOut({node:this.entrySaveCancelButton,duration:250}).play())},_toggleEdit:function(){if(this._editable&&this.enableEdit)g.set(this.entryEditButton,
"display","none"),g.set(this.entrySaveCancelButtons,"display",""),this._editMode=!0,this.setEntry(this._entry,this._feed,!0)},_handleEvent:function(a){a.source!=this&&"delete"==a.action&&a.entry&&a.entry==this._entry&&g.set(this.entryEditButton,"display","none");i.superclass._handleEvent.call(this,a)},_isEditable:function(a){var b=!1;if(a&&null!==a&&a.links&&null!==a.links)for(var c in a.links)if(a.links[c].rel&&"edit"==a.links[c].rel){b=!0;break}return b},setTitle:function(a,b,c){if(b){if(c.title&&
c.title.value&&null!==c.title.value){if(!this._toLoad)this._toLoad=[];this.entryTitleSelect.value=c.title.type;a=this._createEditor(a,c.title,!0,"html"===c.title.type||"xhtml"===c.title.type);a.name="title";this._toLoad.push(a);this.setFieldValidity("titleedit",!0);this.setFieldValidity("title",!0)}}else i.superclass.setTitle.call(this,a,b,c),c.title&&c.title.value&&null!==c.title.value&&this.setFieldValidity("title",!0)},setAuthors:function(a,b,c){if(b){if(c.authors&&0<c.authors.length)this._editors.authors=
this._createPeopleEditor(this.entryAuthorNode,{data:c.authors,name:"Author"}),this.setFieldValidity("authors",!0)}else i.superclass.setAuthors.call(this,a,b,c),c.authors&&0<c.authors.length&&this.setFieldValidity("authors",!0)},setContributors:function(a,b,c){if(b){if(c.contributors&&0<c.contributors.length)this._editors.contributors=this._createPeopleEditor(this.entryContributorNode,{data:c.contributors,name:"Contributor"}),this.setFieldValidity("contributors",!0)}else i.superclass.setContributors.call(this,
a,b,c),c.contributors&&0<c.contributors.length&&this.setFieldValidity("contributors",!0)},setId:function(a,b,c){if(b){if(c.id&&null!==c.id)this._editors.id=this._createEditor(a,c.id),this.setFieldValidity("id",!0)}else i.superclass.setId.call(this,a,b,c),c.id&&null!==c.id&&this.setFieldValidity("id",!0)},setUpdated:function(a,b,c){if(b){if(c.updated&&null!==c.updated)this._editors.updated=this._createEditor(a,c.updated),this.setFieldValidity("updated",!0)}else i.superclass.setUpdated.call(this,a,
b,c),c.updated&&null!==c.updated&&this.setFieldValidity("updated",!0)},setSummary:function(a,b,c){if(b){if(c.summary&&c.summary.value&&null!==c.summary.value){if(!this._toLoad)this._toLoad=[];this.entrySummarySelect.value=c.summary.type;a=this._createEditor(a,c.summary,!0,"html"===c.summary.type||"xhtml"===c.summary.type);a.name="summary";this._toLoad.push(a);this.setFieldValidity("summaryedit",!0);this.setFieldValidity("summary",!0)}}else i.superclass.setSummary.call(this,a,b,c),c.summary&&c.summary.value&&
null!==c.summary.value&&this.setFieldValidity("summary",!0)},setContent:function(a,b,c){if(b){if(c.content&&c.content.value&&null!==c.content.value){if(!this._toLoad)this._toLoad=[];this.entryContentSelect.value=c.content.type;a=this._createEditor(a,c.content,!0,"html"===c.content.type||"xhtml"===c.content.type);a.name="content";this._toLoad.push(a);this.setFieldValidity("contentedit",!0);this.setFieldValidity("content",!0)}}else i.superclass.setContent.call(this,a,b,c),c.content&&c.content.value&&
null!==c.content.value&&this.setFieldValidity("content",!0)},_createEditor:function(a,b,c,d){if(!b){if(d)return{anchorNode:a,entryValue:"",editor:null,generateEditor:function(){var a=document.createElement("div");a.innerHTML=this.entryValue;this.anchorNode.appendChild(a);return this.editor=a=new m({},a)}};c?(c=document.createElement("textarea"),a.appendChild(c),g.set(c,"width","90%"),a=new v({},c)):(c=document.createElement("input"),a.appendChild(c),g.set(c,"width","95%"),a=new o({},c));a.attr("value",
"");return a}b=void 0!==b.value?b.value:b.attr?b.attr("value"):b;if(d)return-1!=b.indexOf("<")&&(b=b.replace(/</g,"&lt;")),{anchorNode:a,entryValue:b,editor:null,generateEditor:function(){var a=document.createElement("div");a.innerHTML=this.entryValue;this.anchorNode.appendChild(a);return this.editor=a=new m({},a)}};c?(c=document.createElement("textarea"),a.appendChild(c),g.set(c,"width","90%"),a=new v({},c)):(c=document.createElement("input"),a.appendChild(c),g.set(c,"width","95%"),a=new o({},c));
a.attr("value",b);return a},_switchEditor:function(a){var b=null,c=null,d=null,c=s("ie")?a.srcElement:a.target;c===this.entryTitleSelect?(d=this.entryTitleNode,b="title"):c===this.entrySummarySelect?(d=this.entrySummaryNode,b="summary"):(d=this.entryContentNode,b="content");a=this._editors[b];if("text"===c.value){if(a.isInstanceOf(m)){c=a.attr("value",!1);a.close(!1,!0);for(a.destroy();d.firstChild;)u.destroy(d.firstChild);d=this._createEditor(d,{value:c},!0,!1);this._editors[b]=d}}else if(!a.isInstanceOf(m)){c=
a.attr("value");for(a.destroy();d.firstChild;)u.destroy(d.firstChild);d=this._createEditor(d,{value:c},!0,!0);d=q.hitch(d,d.generateEditor)();this._editors[b]=d}},_createPeopleEditor:function(a,b){var c=document.createElement("div");a.appendChild(c);return new E(b,c)},saveEdits:function(){g.set(this.entrySaveCancelButtons,"display","none");g.set(this.entryEditButton,"display","");g.set(this.entryNewButton,"display","");var a=!1,b,c,d,e;if(this._new){this._new=!1;d=new l.Entry;a=this._editors.title.attr("value");
"xhtml"===this.entryTitleSelect.value&&(a=this._enforceXhtml(a),a='<div xmlns="http://www.w3.org/1999/xhtml">'+a+"</div>");d.setTitle(a,this.entryTitleSelect.value);d.id=this._editors.id.attr("value");e=this._editors.authors.getValues();for(b in e)(e[b].name||e[b].email||e[b].uri)&&d.addAuthor(e[b].name,e[b].email,e[b].uri);e=this._editors.contributors.getValues();for(b in e)(e[b].name||e[b].email||e[b].uri)&&d.addContributor(e[b].name,e[b].email,e[b].uri);a=this._editors.summary.attr("value");"xhtml"===
this.entrySummarySelect.value&&(a=this._enforceXhtml(a),a='<div xmlns="http://www.w3.org/1999/xhtml">'+a+"</div>");d.summary=new l.Content("summary",a,null,this.entrySummarySelect.value);a=this._editors.content.attr("value");"xhtml"===this.entryContentSelect.value&&(a=this._enforceXhtml(a),a='<div xmlns="http://www.w3.org/1999/xhtml">'+a+"</div>");d.content=new l.Content("content",a,null,this.entryContentSelect.value);g.set(this.entryNewButton,"display","");n.publish(this.entrySelectionTopic,[{action:"post",
source:this,entry:d}])}else{d=this.getEntry();if(this._editors.title&&(this._editors.title.attr("value")!=d.title.value||this.entryTitleSelect.value!=d.title.type))a=this._editors.title.attr("value"),"xhtml"===this.entryTitleSelect.value&&(a=this._enforceXhtml(a),0!==a.indexOf('<div xmlns="http://www.w3.org/1999/xhtml">')&&(a='<div xmlns="http://www.w3.org/1999/xhtml">'+a+"</div>")),d.title=new l.Content("title",a,null,this.entryTitleSelect.value),a=!0;if(this._editors.id.attr("value")!=d.id)d.id=
this._editors.id.attr("value"),a=!0;if(this._editors.summary&&(this._editors.summary.attr("value")!=d.summary.value||this.entrySummarySelect.value!=d.summary.type))a=this._editors.summary.attr("value"),"xhtml"===this.entrySummarySelect.value&&(a=this._enforceXhtml(a),0!==a.indexOf('<div xmlns="http://www.w3.org/1999/xhtml">')&&(a='<div xmlns="http://www.w3.org/1999/xhtml">'+a+"</div>")),d.summary=new l.Content("summary",a,null,this.entrySummarySelect.value),a=!0;if(this._editors.content&&(this._editors.content.attr("value")!=
d.content.value||this.entryContentSelect.value!=d.content.type))a=this._editors.content.attr("value"),"xhtml"===this.entryContentSelect.value&&(a=this._enforceXhtml(a),0!==a.indexOf('<div xmlns="http://www.w3.org/1999/xhtml">')&&(a='<div xmlns="http://www.w3.org/1999/xhtml">'+a+"</div>")),d.content=new l.Content("content",a,null,this.entryContentSelect.value),a=!0;if(this._editors.authors)if(a)for(b in d.authors=[],e=this._editors.authors.getValues(),e)(e[b].name||e[b].email||e[b].uri)&&d.addAuthor(e[b].name,
e[b].email,e[b].uri);else{var f=d.authors;e=this._editors.authors.getValues();c=!1;for(b in e){var h;a:{for(b in f)if(f[b].name===e[b].name&&f[b].email===e[b].email&&f[b].uri===e[b].uri){h=!0;break a}h=!1}if(!h){c=!0;break}}if(c){d.authors=[];for(b in e)(e[b].name||e[b].email||e[b].uri)&&d.addAuthor(e[b].name,e[b].email,e[b].uri);a=!0}}if(this._editors.contributors)if(a)for(b in d.contributors=[],e=this._editors.contributors.getValues(),e)(e[b].name||e[b].email||e[b].uri)&&d.addAuthor(e[b].name,e[b].email,
e[b].uri);else{f=d.contributors;e=this._editors.contributors.getValues();c=!1;for(b in e){a:{for(b in f)if(f[b].name===e[b].name&&f[b].email===e[b].email&&f[b].uri===e[b].uri){h=!0;break a}h=!1}if(h){c=!0;break}}if(c){d.contributors=[];for(b in e)(e[b].name||e[b].email||e[b].uri)&&d.addContributor(e[b].name,e[b].email,e[b].uri);a=!0}}a&&n.publish(this.entrySelectionTopic,[{action:"update",source:this,entry:d,callback:this._handleSave}])}this._editMode=!1;this.setEntry(d,this._feed,!0)},_handleSave:function(a){this._editMode=
!1;this.clear();this.setEntry(a,this.getFeed(),!0)},cancelEdits:function(){this._new=!1;g.set(this.entrySaveCancelButtons,"display","none");this._editable&&g.set(this.entryEditButton,"display","");g.set(this.entryNewButton,"display","");this._editMode=!1;this.clearEditors();this.setEntry(this.getEntry(),this.getFeed(),!0)},clear:function(){this._editable=!1;this.clearEditors();i.superclass.clear.apply(this);if(this._contentEditor)this._contentEditor=this._setObject=this._oldContent=this._contentEditorCreator=
null,this._editors={}},clearEditors:function(){for(var a in this._editors)this._editors[a].isInstanceOf(m)&&this._editors[a].close(!1,!0),this._editors[a].destroy();this._editors={}},_enforceXhtml:function(a){var b=null;a&&(b=a.replace(/<br>/g,"<br/>"),b=this._closeTag(b,"hr"),b=this._closeTag(b,"img"));return b},_closeTag:function(a,b){var c="<"+b,d=a.indexOf(c);if(-1!==d)for(;-1!==d;){for(var e="",f=!1,g=0;g<a.length;g++){var i=a.charAt(g);if(!(g<=d||f)&&">"===i)e+="/",f=!0;e+=i}a=e;d=a.indexOf(c,
d+1)}return a},_toggleNew:function(){g.set(this.entryNewButton,"display","none");g.set(this.entryEditButton,"display","none");g.set(this.entrySaveCancelButtons,"display","");this.entrySummarySelect.value="text";this.entryContentSelect.value="text";this.entryTitleSelect.value="text";this.clearNodes();this._new=!0;this.entryTitleHeader.appendChild((new j.EntryHeader({title:k.title})).domNode);this._editors.title=this._createEditor(this.entryTitleNode,null);this.setFieldValidity("title",!0);this.entryAuthorHeader.appendChild((new j.EntryHeader({title:k.authors})).domNode);
this._editors.authors=this._createPeopleEditor(this.entryAuthorNode,{name:"Author"});this.setFieldValidity("authors",!0);this.entryContributorHeader.appendChild((new j.EntryHeader({title:k.contributors})).domNode);this._editors.contributors=this._createPeopleEditor(this.entryContributorNode,{name:"Contributor"});this.setFieldValidity("contributors",!0);this.entryIdHeader.appendChild((new j.EntryHeader({title:k.id})).domNode);this._editors.id=this._createEditor(this.entryIdNode,null);this.setFieldValidity("id",
!0);this.entryUpdatedHeader.appendChild((new j.EntryHeader({title:k.updated})).domNode);this._editors.updated=this._createEditor(this.entryUpdatedNode,null);this.setFieldValidity("updated",!0);this.entrySummaryHeader.appendChild((new j.EntryHeader({title:k.summary})).domNode);this._editors.summary=this._createEditor(this.entrySummaryNode,null,!0);this.setFieldValidity("summaryedit",!0);this.setFieldValidity("summary",!0);this.entryContentHeader.appendChild((new j.EntryHeader({title:k.content})).domNode);
this._editors.content=this._createEditor(this.entryContentNode,null,!0);this.setFieldValidity("contentedit",!0);this.setFieldValidity("content",!0);this._displaySections()},_displaySections:function(){g.set(this.entrySummarySelect,"display","none");g.set(this.entryContentSelect,"display","none");g.set(this.entryTitleSelect,"display","none");this.isFieldValid("contentedit")&&g.set(this.entryContentSelect,"display","");this.isFieldValid("summaryedit")&&g.set(this.entrySummarySelect,"display","");this.isFieldValid("titleedit")&&
g.set(this.entryTitleSelect,"display","");i.superclass._displaySections.apply(this);if(this._toLoad){for(var a in this._toLoad){var b;b=this._toLoad[a].generateEditor?q.hitch(this._toLoad[a],this._toLoad[a].generateEditor)():this._toLoad[a];this._editors[this._toLoad[a].name]=b;this._toLoad[a]=null}this._toLoad=null}}}),E=r("dojox.atom.widget.PeopleEditor",[y,z,A],{templateString:C,_rows:[],_editors:[],_index:0,_numRows:0,postCreate:function(){this.name?"Author"==this.name?this.peopleEditorButton.appendChild(document.createTextNode("["+
p.addAuthor+"]")):"Contributor"==this.name&&this.peopleEditorButton.appendChild(document.createTextNode("["+p.addContributor+"]")):this.peopleEditorButton.appendChild(document.createTextNode("["+p.add+"]"));this._editors=[];if(!this.data||0===this.data.length)this._createEditors(null,null,null,0,this.name),this._index=1;else for(var a in this.data)this._createEditors(this.data[a].name,this.data[a].email,this.data[a].uri,a),this._index++,this._numRows++},destroy:function(){for(var a in this._editors)for(var b in this._editors[a])this._editors[a][b].destroy();
this._editors=[]},_createEditors:function(a,b,c,d,e){var f=document.createElement("tr");this.peopleEditorEditors.appendChild(f);f.id="removeRow"+d;var h=document.createElement("td");h.setAttribute("align","right");f.appendChild(h);h.colSpan=2;if(0<this._numRows)f=document.createElement("hr"),h.appendChild(f),f.id="hr"+d;f=document.createElement("span");h.appendChild(f);f.className="peopleEditorButton";g.set(f,"font-size","x-small");w.connect(f,"onclick",this,"_removeEditor");f.id="remove"+d;h=document.createTextNode("[X]");
f.appendChild(h);f=document.createElement("tr");this.peopleEditorEditors.appendChild(f);f.id="editorsRow"+d;var i=document.createElement("td");f.appendChild(i);g.set(i,"width","20%");h=document.createElement("td");f.appendChild(h);f=document.createElement("table");i.appendChild(f);g.set(f,"width","100%");i=document.createElement("tbody");f.appendChild(i);f=document.createElement("table");h.appendChild(f);g.set(f,"width","100%");h=document.createElement("tbody");f.appendChild(h);this._editors[d]=[];
this._editors[d].push(this._createEditor(a,e+"name"+d,"Name:",i,h));this._editors[d].push(this._createEditor(b,e+"email"+d,"Email:",i,h));this._editors[d].push(this._createEditor(c,e+"uri"+d,"URI:",i,h))},_createEditor:function(a,b,c,d,e){var f=document.createElement("tr");d.appendChild(f);var h=document.createElement("label");h.setAttribute("for",b);h.appendChild(document.createTextNode(c));d=document.createElement("td");d.appendChild(h);f.appendChild(d);f=document.createElement("tr");e.appendChild(f);
e=document.createElement("td");f.appendChild(e);c=document.createElement("input");c.setAttribute("id",b);e.appendChild(c);g.set(c,"width","95%");b=new o({},c);b.attr("value",a);return b},_removeEditor:function(a){var b=null,b=s("ie")?a.srcElement:a.target,a=b.id,a=a.substring(6),c;for(c in this._editors[a])this._editors[a][c].destroy();c=t.byId("editorsRow"+a);b=c.parentNode;b.removeChild(c);c=t.byId("removeRow"+a);b=c.parentNode;b.removeChild(c);this._numRows--;if(1===this._numRows&&"hr"===b.firstChild.firstChild.firstChild.tagName.toLowerCase())c=
b.firstChild.firstChild,c.removeChild(c.firstChild);this._editors[a]=null},_add:function(){this._createEditors(null,null,null,this._index);this._index++;this._numRows++},getValues:function(){var a=[],b;for(b in this._editors)this._editors[b]&&a.push({name:this._editors[b][0].attr("value"),email:this._editors[b][1].attr("value"),uri:this._editors[b][2].attr("value")});return a}});return i});