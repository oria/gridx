//>>built
define("gridx/modules/SingleSort","dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/keys ../core/model/extensions/Sort ../core/_Module".split(" "),function(f,g,e,h,k,l){return f(l,{name:"sort",forced:["header"],modelExtensions:[k],preload:function(){var a=this,b=a.grid,c;a.connect(b,"onHeaderCellClick","_onClick");a.connect(b,"onHeaderCellKeyDown","_onKey");b.persist&&(c=b.persist.registerAndLoad("sort",function(){return[{colId:a._sortId,descending:a._sortDescend}]}));c=c||a.arg("initialOrder");
g.isArrayLike(c)&&(c=c[0]);c&&c.colId&&(a._sortId=c.colId,a._sortDescend=c.descending,a.model.sort([c]))},load:function(){var a=this,b=function(){var b=a.grid._columnsById,d;for(d in b)a._initHeader(d);a._sortId&&b[a._sortId]&&a._updateHeader(a._sortId,a._sortDescend)};a.connect(a.grid.header,"onRender",b);b();a.loaded.callback()},columnMixin:{sort:function(a,b){this.grid.sort.sort(this.id,a,b);return this},isSorted:function(){return this.grid.sort.isSorted(this.id)},clearSort:function(a){this.isSorted()&&
this.grid.sort.clear(a);return this},isSortable:function(){var a=this.grid._columnsById[this.id];return a.sortable||void 0===a.sortable},setSortable:function(a){this.grid._columnsById[this.id].sortable=!!a;return this}},sort:function(a,b,c){var d=this.grid,e=d._columnsById[a];if(e&&(e.sortable||void 0===e.sortable))(this._sortId!=a||this._sortDescend==!b)&&this._updateHeader(a,b),this.model.sort([{colId:a,descending:b}]),c||d.body.refresh()},isSorted:function(a){return a==this._sortId?this._sortDescend?
-1:1:0},clear:function(a){if(null!==this._sortId){var b=this.grid.header.getHeaderNode(this._sortId);b&&(e.remove(b,"gridxCellSorted"),e.remove(b,"gridxCellSortedAsc"),e.remove(b,"gridxCellSortedDesc"));this._sortId=this._sortDescend=null;this.model.sort();a||this.grid.body.refresh()}},getSortData:function(){return this._sortId?[{colId:this._sortId,descending:this._sortDescend}]:null},_sortId:null,_sortDescend:null,_initHeader:function(a){var b=this.grid,c=b.header.getHeaderNode(a);a=b.column(a,1);
b=[];a.isSortable()&&(b.push("\x3cdiv role\x3d'presentation' class\x3d'gridxArrowButtonNode'\x3e","\x3cdiv class\x3d'gridxArrowButtonCharAsc'\x3e\x26#9652;\x3c/div\x3e","\x3cdiv class\x3d'gridxArrowButtonCharDesc'\x3e\x26#9662;\x3c/div\x3e","\x3c/div\x3e"),c.setAttribute("aria-sort","none"));b.push("\x3cdiv class\x3d'gridxSortNode'\x3e",a.name(),"\x3c/div\x3e");c.innerHTML=b.join("")},_updateHeader:function(a,b){var c=this.grid,d;if(this._sortId&&this._sortId!=a&&(d=c.header.getHeaderNode(this._sortId)))e.remove(d,
"gridxCellSorted"),e.remove(d,"gridxCellSortedAsc"),e.remove(d,"gridxCellSortedDesc"),d.setAttribute("aria-sort","none");this._sortId=a;this._sortDescend=b=!!b;d=c.header.getHeaderNode(a);e.add(d,"gridxCellSorted");e.toggle(d,"gridxCellSortedAsc",!b);e.toggle(d,"gridxCellSortedDesc",b);d.setAttribute("aria-sort",b?"descending":"ascending");c.vLayout.reLayout()},_onClick:function(a){this.sort(a.columnId,this._sortId!=a.columnId?0:!this._sortDescend)},_onKey:function(a){a.keyCode==h.ENTER&&this._onClick(a)}})});
//@ sourceMappingURL=SingleSort.js.map