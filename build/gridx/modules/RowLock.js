//>>built
define("gridx/modules/RowLock","dojo/_base/kernel dojo/_base/lang ../core/_Module dojo/_base/declare dojo/_base/array dojo/dom-class dojo/aspect dojo/query".split(" "),function(g,m,h,k,n,f,l,p){g.experimental("gridx/modules/RowLock");return k(h,{name:"rowLock",required:["vLayout"],forced:["hLayout","body"],count:0,load:function(c,b){this.count=this.arg("count");var a=this,d=this.grid;b.then(function(){a.grid.vScroller&&(a.connect(d.vScrollerNode,"onscroll",function(){a._updateRowPosition()}),a.connect(d.bodyNode,
"onscroll",function(){a._updateRowPosition()}),a.connect(d.body,"onAfterCell",function(b){b.row.visualIndex()<a.count&&(a._adjustBody(),a._updatePosition())}));a.grid.vScroller&&a.grid.rowHeader&&a.connect(d.bodyNode,"onscroll",function(){a._updateRowHeaderPosition()});d.columnResizer&&(a.connect(d.columnResizer,"onResize","_adjustBody"),a.connect(d.columnResizer,"onResize","_updatePosition"));a.lock(a.count);a.loaded.callback()});l.before(d.body,"refresh",function(){a.grid.bodyNode.style.paddingTop=
"0px"});this.connect(d.body,"refresh",function(){setTimeout(function(){a.lock(a.count)},0)})},lock:function(c){this.unlock();this.count=c;this._foreachLockedRows(function(b){b.style.position="absolute";f.add(b,"gridxLockedRow")},function(b){b.style.position="absolute"});this._adjustBody();this._updatePosition()},unlock:function(){this._foreachLockedRows(function(c){c.style.position="static";f.remove(c,"gridxLockedRow")},function(c){c.style.position="static"});this.grid.bodyNode.style.paddingTop="0px";
this.grid.rowHeader&&(this.grid.rowHeader.bodyNode.style.paddingTop="0px");this.count=0},_adjustBody:function(){var c=0;this._foreachLockedRows(function(b){c+=b.offsetHeight},function(b){});this.grid.bodyNode.style.paddingTop=c+"px";this.grid.rowHeader&&(this.grid.rowHeader.bodyNode.style.paddingTop=c+"px")},_updatePosition:function(){this._updateRowPosition();this.grid.rowHeader&&this._updateRowHeaderPosition()},_updateRowPosition:function(){if(this.count){var c=this.grid.bodyNode.scrollTop,b=0;
this._foreachLockedRows(function(a){a.style.top=c+b+"px";b+=a.offsetHeight},null)}},_updateRowHeaderPosition:function(){if(this.count){var c=this.grid.bodyNode.scrollTop,b=0;this._foreachLockedRows(null,function(a){a.style.top=c+b+"px";b+=a.offsetHeight})}},_foreachLockedRows:function(c,b){for(var a=this.grid.bodyNode.childNodes,d=this.grid.rowHeader?this.grid.rowHeader.bodyNode.childNodes:[],e=0;e<this.count;e++)d[e]&&b&&b(d[e]),a[e]&&c&&c(a[e])}})});
//@ sourceMappingURL=RowLock.js.map