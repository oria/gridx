//>>built
define("gridx/modules/extendedSelect/_Base","dojo/_base/declare dojo/query dojo/_base/connect dojo/_base/Deferred dojo/_base/sniff dojo/_base/window dojo/dom dojo/keys ../../core/_Module ../AutoScroll".split(" "),function(m,n,h,k,g,p,f,l,q){return m(q,{required:["autoScroll"],getAPIPath:function(){var a={select:{}};a.select[this._type]=this;return a},load:function(){var a=this,b=a.grid,c=p.doc;b.domNode.setAttribute("aria-multiselectable",!0);a._refSelectedIds=[];a.subscribe("gridClearSelection_"+
b.id,function(b){b!=a._type&&a.clear()});a.batchConnect([b.body,"onRender","_onRender"],[c,"onmouseup","_end"],[c,"onkeydown",function(a){a.keyCode==l.SHIFT&&f.setSelectable(9<g("ie")?c.body:b.domNode,!1)}],[c,"onkeyup",function(a){a.keyCode==l.SHIFT&&f.setSelectable(9<g("ie")?c.body:b.domNode,!0)}]);a._init();a.loaded.callback()},enabled:!0,canSwept:!0,holdingCtrl:!1,holdingShift:!1,selectById:function(){return this._subMark("_markById",arguments,!0)},deselectById:function(){return this._subMark("_markById",
arguments,!1)},selectByIndex:function(){return this._subMark("_markByIndex",arguments,!0)},deselectByIndex:function(){return this._subMark("_markByIndex",arguments,!1)},onSelectionChange:function(){},_clear:function(){delete this._lastToSelect;delete this._lastStartItem;delete this._lastEndItem},_subMark:function(a,b,c){var d=this;if(d.arg("enabled"))return c&&h.publish("gridClearSelection_"+d.grid.id,[d._type]),d._lastSelectedIds=d.getSelected(),d._refSelectedIds=[],k.when(d[a](b,c),function(){d._onSelectionChange()})},
_start:function(a,b,c){var d=this.grid.model;if(!this._selecting&&!this._marking&&this.arg("enabled")){f.setSelectable(this.grid.domNode,!1);this._fixFF(1);var e=!0===this._isSelected(a);(c=c||this.arg("holdingShift"))&&this._lastStartItem?(this._isRange=1,this._toSelect=this._lastToSelect,this._startItem=this._lastStartItem,this._currentItem=this._lastEndItem):(this._startItem=a,this._currentItem=null,b||this.arg("holdingCtrl")?(this._toSelect=!e,"row"===this._type&&(d.treeMarkMode()&&!this._isSelected(a)&&
this._toSelect)&&(this._toSelect="mixed")):(this._toSelect=1,"row"===this._type&&(d.treeMarkMode()&&!this._isSelected(a)&&this._toSelect)&&(this._toSelect="mixed"),this.clear(1)));h.publish("gridClearSelection_"+this.grid.id,[this._type]);this._beginAutoScroll();this.grid.autoScroll.enabled=!0;this._lastSelectedIds=this.getSelected();this._selecting=1;this._highlight(a)}},_highlight:function(a){var b=this;if(b._selecting){var c=b._type,d=b._startItem,e=b._currentItem,f=function(a,d,e){a=a[c];d=d[c];
for(var f=a<d?1:-1;a!=d;a+=f){var g={};g[c]=a;b._highlightSingle(g,e)}};null===e?b._highlightSingle(a,1):b._inRange(a[c],d[c],e[c])?f(e,a,0):(b._inRange(d[c],a[c],e[c])&&(f(e,d,0),e=d),f(a,e,1));b._currentItem=a;b._focus(a)}},_end:function(){var a=this,b=a.grid;if(a._selecting){a._fixFF();a._endAutoScroll();a._selecting=0;a._marking=1;b.autoScroll.enabled=!1;var c=a._addToSelected(a._startItem,a._currentItem,a._toSelect);a._lastToSelect=a._toSelect;a._lastStartItem=a._startItem;a._lastEndItem=a._currentItem;
a._startItem=a._currentItem=a._isRange=null;k.when(c,function(){f.setSelectable(b.domNode,!0);a._marking=0;a._onSelectionChange()})}},_highlightSingle:function(a,b){b=b?this._toSelect:this._isSelected(a);this._doHighlight(a,b)},_onSelectionChange:function(){var a=this.getSelected();this.onSelectionChange(a,this._lastSelectedIds);this._lastSelectedIds=a},_inRange:function(a,b,c,d){return(a>=b&&a<=c||a>=c&&a<=b)&&(d||a!=c)},_fixFF:function(a){g("ff")&&n(".gridxSortNode",this.grid.headerNode).style("overflow",
a?"visible":"")}})});
//@ sourceMappingURL=_Base.js.map