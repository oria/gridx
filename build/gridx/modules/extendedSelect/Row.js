//>>built
define("gridx/modules/extendedSelect/Row","dojo/_base/declare dojo/_base/array dojo/_base/event dojo/query dojo/_base/lang dojo/_base/Deferred dojo/_base/sniff dojo/dom-class dojo/mouse dojo/keys ../../core/_Module ./_RowCellBase".split(" "),function(q,m,r,k,p,s,t,f,u,n,w,v){return q(v,{name:"selectRow",rowMixin:{select:function(){this.grid.select.row.selectById(this.id);return this},deselect:function(){this.grid.select.row.deselectById(this.id);return this},isSelected:function(){return!0===this.model.getMark(this.id)},
isSelectable:function(){return this.grid.select.row._isSelectable(this.id)},setSelectable:function(a){this.grid.select.row.setSelectable(this.id,a)}},treeMode:!0,setSelectable:function(a,b){var c=this.model,e=this.grid.body.getRowNode({rowId:a});c.setMarkable(a,b);this.unselectable[a]=!b;e&&(f.toggle(e,"gridxRowUnselectable",!b),this.onHighlightChange({row:parseInt(e.getAttribute("visualindex"),10)},c.getMark(a)),this.onSelectionChange())},getSelected:function(){return this.model.getMarkedIds()},
isSelected:function(){return m.every(arguments,function(a){return!0===this.model.getMark(a)},this)},clear:function(a){k(".gridxRowSelected",this.grid.mainNode).forEach(function(b){f.remove(b,"gridxRowSelected");b.removeAttribute("aria-selected")});k(".gridxRowPartialSelected",this.grid.mainNode).forEach(function(b){f.remove(b,"gridxRowPartialSelected")});this._clear();this.model.clearMark();a||this._onSelectionChange()},onHighlightChange:function(){},_type:"row",_isSelectable:function(a){return!this.arg("unselectable",
{})[a]},_getUnselectableRows:function(){var a=[],b=this.arg("unselectable"),c;for(c in b)b[c]&&this.model.byId(c)&&a.push(c);return a},_init:function(){function a(d){if(d.columnId){var a=c._columnsById[d.columnId];return b.arg("triggerOnCell")?!1!==a.rowSelectable&&!f.contains(d.target,"gridxTreeExpandoIcon")&&!f.contains(d.target,"gridxTreeExpandoInner"):a.rowSelectable}return!d.columnId}var b=this,c=b.grid,e=b.arg("unselectable",{});b.model.treeMarkMode("",b.arg("treeMode"));for(var h in e)b.model.setMarkable(h,
!e[h]);b.inherited(arguments);b.model._spTypes.select=1;b.model.setMarkable(p.hitch(b,b._isSelectable));b.batchConnect(c.rowHeader&&[c.rowHeader,"onMoveToRowHeaderCell","_onMoveToRowHeaderCell"],[c,"onRowMouseDown",function(d){u.isLeft(d)&&a(d)&&(b._isOnCell=d.columnId,b._isOnCell&&(c.body._focusCellCol=d.columnIndex),b._start({row:d.visualIndex},c._isCtrlKey(d),d.shiftKey),!d.shiftKey&&!b.arg("canSwept")&&b._end())}],[c,"onRowTouchStart",function(d){a(d)&&(b._isOnCell=d.columnId,b._isOnCell&&(c.body._focusCellCol=
d.columnIndex),b._start({row:d.visualIndex},c._isCtrlKey(d)||"__indirectSelect__"===d.columnId,d.shiftKey),!d.shiftKey&&!b.arg("canSwept")&&b._end())}],[c,"onRowTouchEnd","_end"],[c.body,"onAfterRow",function(b){var a=!b.isSelectable();f.toggle(b.node(),"gridxRowUnselectable",a)}],[c,"onRowMouseOver",function(a){b._selecting&&(b.arg("triggerOnCell")&&a.columnId)&&(c.body._focusCellCol=a.columnIndex);b._highlight({row:a.visualIndex})}],[c,4>t("ff")?"onRowKeyUp":"onRowKeyDown",function(a){if(a.keyCode==
n.SPACE&&(!a.columnId||c._columnsById[a.columnId].rowSelectable||b.arg("triggerOnCell")&&(!c.focus||"body"==c.focus.currentArea())))r.stop(a),b._isOnCell=a.columnId,b._start({row:a.visualIndex},c._isCtrlKey(a),a.shiftKey),b._end()}],[c.model,"setStore","_syncUnselectable"])},_markById:function(a,b){var c=this.model;m.forEach(a,function(a){c.markById(a,b)});c.when()},_markByIndex:function(a,b){var c=this.model,e=this.grid.view,h;m.forEach(a,function(a){if(p.isArrayLike(a)){var g=a[0];a=a[1];var f;
if(0<=g&&Infinity>g){f=a>=g&&Infinity>a?a-g+1:e.visualCount-g;h=e.getRowInfo({visualIndex:g});g=h.rowIndex;for(a=0;a<f;++a)c.markByIndex(a+g,b,"",h.parentId)}}else 0<=a&&Infinity>a&&(h=e.getRowInfo({visualIndex:a}),c.markByIndex(h.rowIndex,b,"",h.parentId))});return c.when()},_onRender:function(a,b){var c,e=a+b;for(c=a;c<e;++c){var h={row:c},d=this._isSelected(h)||this._selecting&&this._toSelect&&this._inRange(c,this._startItem.row,this._currentItem.row,1);d&&this._doHighlight(h,d)}},_onMark:function(a,
b,c,e){"select"==e&&(a=k('[rowid\x3d"'+this.grid._escapeId(a)+'"]',this.grid.mainNode),a.length&&(a.forEach(function(a){var c=b&&"mixed"!=b;f.toggle(a,"gridxRowSelected",c);f.toggle(a,"gridxRowPartialSelected","mixed"==b);a.setAttribute("aria-selected",!!c)}),this.onHighlightChange({row:parseInt(a[0].getAttribute("visualindex"),10)},b)))},_onMoveToCell:function(a,b,c){if(this.arg("triggerOnCell")&&c.shiftKey&&(c.keyCode==n.UP_ARROW||c.keyCode==n.DOWN_ARROW))this._start({row:a},this.grid._isCtrlKey(c),
1),this._end()},_onMoveToRowHeaderCell:function(a,b){b.shiftKey&&(this._start({row:a},this.grid._isCtrlKey(b),1),this._end())},_isSelected:function(a){a=this._getRowId(a.row);return this._isRange?0<=m.indexOf(this._refSelectedIds,a):this.model.getMark(a)},_beginAutoScroll:function(){this.grid.autoScroll.horizontal=!1},_endAutoScroll:function(){this.grid.autoScroll.horizontal=!0},_doHighlight:function(a,b){k('[visualindex\x3d"'+a.row+'"]',this.grid.mainNode).forEach(function(a){var e=b&&"mixed"!=b;
f.toggle(a,"gridxRowSelected",e);f.toggle(a,"gridxRowPartialSelected","mixed"==b);a.setAttribute("aria-selected",!!e)});this.onHighlightChange(a,b)},_end:function(){this.inherited(arguments);delete this._isOnCell},_focus:function(a){var b=this.grid,c=b.focus;c&&(b.body._focusCellRow=a.row,c.focusArea(this._isOnCell?"body":"rowHeader",!0))},_addToSelected:function(a,b,c){var e=this,h=e.grid.view,d=e.model,g=e._lastEndItem,f,l,k;e._isRange||(e._refSelectedIds=d.getMarkedIds());if(e._isRange&&e._inRange(b.row,
a.row,g.row))return f=Math.min(b.row,g.row),g=Math.max(b.row,g.row),a=h.getRowInfo({visualIndex:f}).rowIndex+1,b=h.getRowInfo({visualIndex:g}).rowIndex,k=new s,d.when({start:a,count:b-a+1},function(){for(l=a;l<=b;++l){var c=d.indexToId(l),f=0<=m.indexOf(e._refSelectedIds,c);d.markById(c,f)}}).then(function(){d.when(null,function(){k.callback()})}),k;f=Math.min(a.row,b.row);g=Math.max(a.row,b.row);for(l=f;l<=g;++l)f=h.getRowInfo({visualIndex:l}),d.markByIndex(f.rowIndex,c,"",f.parentId);return d.when()},
_highlightSingle:function(a,b){var c=this._getRowId(a.row);b=this._isSelectable(c)?b?this._toSelect:this._isSelected(a):this.model.getMark(c);this._doHighlight(a,b)},_syncUnselectable:function(){var a=this.arg("unselectable"),b;for(b in a)this.model.setMarkable(b,!a[b])}})});
//@ sourceMappingURL=Row.js.map